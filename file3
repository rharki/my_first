this is where the branching fun starts
